{"ast":null,"code":"import { getUserList, updateUserState } from \"../api\";\nexport default {\n  name: \"Users\",\n  data() {\n    return {\n      queryInfo: {\n        query: \"\",\n        pagenum: 1,\n        // 当前每页显示数据条数\n        pagesize: 2\n      },\n      userList: [],\n      total: 0,\n      isVisible: false,\n      // 添加用户的表单数据\n      addForm: {},\n      // 表单验证规则对象\n      rules: {\n        username: [{\n          required: true,\n          message: \"请输入用户名称\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"请输入用户名称\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  methods: {\n    // 获取用户数据列表\n    getUserListd() {\n      getUserList({\n        params: this.queryInfo\n      }).then(({\n        data\n      }) => {\n        // console.log(data);\n        if (data.meta.status !== 200) return this.$message.error(data.meta.msg);\n        this.userList = data.data.users;\n        this.total = data.data.total;\n      });\n    },\n    // 监听pagesize变化\n    handleSizeChange(newSize) {\n      // console.log(newSize);\n      this.queryInfo.pagesize = newSize;\n      this.getUserListd();\n    },\n    // 监听 页码值的事件\n    handleCurrentChange(newPage) {\n      // console.log(newPage);\n      this.queryInfo.pagenum = newPage;\n      this.getUserListd();\n    },\n    // 监听switch状态的改变\n    userStateChanged(userinfo) {\n      updateUserState(userinfo).then(({\n        data\n      }) => {\n        // console.log(data);\n        if (data.meta.status !== 200) {\n          userinfo.mg_state = !userinfo.mg_state;\n          return this.$message.error(\"更新状态失败\");\n        }\n        this.$message.success(\"更新状态成功\");\n      });\n    }\n  },\n  mounted() {\n    this.getUserListd();\n  }\n};","map":{"version":3,"names":["getUserList","updateUserState","name","data","queryInfo","query","pagenum","pagesize","userList","total","isVisible","addForm","rules","username","required","message","trigger","password","methods","getUserListd","params","then","meta","status","$message","error","msg","users","handleSizeChange","newSize","handleCurrentChange","newPage","userStateChanged","userinfo","mg_state","success","mounted"],"sources":["src/views/Users.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 面包屑 -->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>活动管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>活动列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 视图 -->\r\n    <el-card>\r\n      <!-- 添加与搜索 -->\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"7\">\r\n          <el-input\r\n            placeholder=\"请输入内容\"\r\n            v-model.trim=\"queryInfo.query\"\r\n            clearable\r\n            @clear=\"getUserListd\"\r\n          >\r\n            <el-button\r\n              slot=\"append\"\r\n              icon=\"el-icon-search\"\r\n              @click=\"getUserListd\"\r\n            ></el-button>\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <el-button type=\"primary\" @click=\"isVisible = true\"\r\n            >添加用户</el-button\r\n          >\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 用户列表区 -->\r\n      <el-table :data=\"userList\" border stripe>\r\n        <el-table-column label=\"#\" type=\"index\"></el-table-column>\r\n        <el-table-column label=\"姓名\" prop=\"username\"></el-table-column>\r\n        <el-table-column label=\"邮箱\" prop=\"email\"></el-table-column>\r\n        <el-table-column label=\"电话\" prop=\"mobile\"></el-table-column>\r\n        <el-table-column label=\"角色\" prop=\"role_name\"></el-table-column>\r\n        <el-table-column label=\"状态\">\r\n          <template slot-scope=\"scope\"\r\n            ><el-switch\r\n              v-model=\"scope.row.mg_state\"\r\n              @change=\"userStateChanged(scope.row)\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n            >\r\n            </el-switch\r\n          ></template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"primary\" icon=\"el-icon-edit\"></el-button>\r\n            <el-button type=\"danger\" icon=\"el-icon-delete\"></el-button>\r\n            <el-tooltip\r\n              effect=\"dark\"\r\n              content=\"分配权限\"\r\n              placement=\"top\"\r\n              :enterable=\"false\"\r\n              ><el-button type=\"warning\" icon=\"el-icon-setting\"></el-button\r\n            ></el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页 -->\r\n      <el-pagination\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"queryInfo.pagenum\"\r\n        :page-sizes=\"[1, 2, 5, 10]\"\r\n        :page-size=\"queryInfo.pagesize\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        :total=\"total\"\r\n      >\r\n      </el-pagination>\r\n    </el-card>\r\n\r\n    <!-- 添加用户对话框 -->\r\n    <el-dialog title=\"添加用户\" :visible.sync=\"isVisible\" width=\"50%\">\r\n      <el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\" label-width=\"70px\">\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input v-model=\"addForm.username\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" prop=\"password\">\r\n          <el-input v-model=\"addForm.username\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"手机\" prop=\"username\">\r\n          <el-input v-model=\"addForm.username\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"邮箱\" prop=\"username\">\r\n          <el-input v-model=\"addForm.username\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"isVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"isVisible = false\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getUserList, updateUserState } from \"../api\";\r\nexport default {\r\n  name: \"Users\",\r\n  data() {\r\n    return {\r\n      queryInfo: {\r\n        query: \"\",\r\n        pagenum: 1,\r\n        // 当前每页显示数据条数\r\n        pagesize: 2,\r\n      },\r\n      userList: [],\r\n      total: 0,\r\n      isVisible: false,\r\n      // 添加用户的表单数据\r\n      addForm: {},\r\n      // 表单验证规则对象\r\n      rules: {\r\n        username: [\r\n          { required: true, message: \"请输入用户名称\", trigger: \"blur\" },\r\n        ],\r\n        password: [\r\n          { required: true, message: \"请输入用户名称\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    // 获取用户数据列表\r\n    getUserListd() {\r\n      getUserList({ params: this.queryInfo }).then(({ data }) => {\r\n        // console.log(data);\r\n        if (data.meta.status !== 200) return this.$message.error(data.meta.msg);\r\n        this.userList = data.data.users;\r\n        this.total = data.data.total;\r\n      });\r\n    },\r\n    // 监听pagesize变化\r\n    handleSizeChange(newSize) {\r\n      // console.log(newSize);\r\n      this.queryInfo.pagesize = newSize;\r\n      this.getUserListd();\r\n    },\r\n    // 监听 页码值的事件\r\n    handleCurrentChange(newPage) {\r\n      // console.log(newPage);\r\n      this.queryInfo.pagenum = newPage;\r\n      this.getUserListd();\r\n    },\r\n    // 监听switch状态的改变\r\n    userStateChanged(userinfo) {\r\n      updateUserState(userinfo).then(({ data }) => {\r\n        // console.log(data);\r\n        if (data.meta.status !== 200) {\r\n          userinfo.mg_state = !userinfo.mg_state;\r\n          return this.$message.error(\"更新状态失败\");\r\n        }\r\n        this.$message.success(\"更新状态成功\");\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getUserListd();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.el-breadcrumb {\r\n  margin-bottom: 15px;\r\n  font-size: 14px;\r\n}\r\n.el-card {\r\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\r\n}\r\n.el-table {\r\n  margin-top: 15px;\r\n  font-size: 14px;\r\n}\r\n.el-pagination {\r\n  margin-top: 15px;\r\n}\r\n</style>"],"mappings":"AAsGA,SAAAA,WAAA,EAAAC,eAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;QACAC,KAAA;QACAC,OAAA;QACA;QACAC,QAAA;MACA;MACAC,QAAA;MACAC,KAAA;MACAC,SAAA;MACA;MACAC,OAAA;MACA;MACAC,KAAA;QACAC,QAAA,GACA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAC,QAAA,GACA;UAAAH,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAE,OAAA;IACA;IACAC,aAAA;MACAnB,WAAA;QAAAoB,MAAA,OAAAhB;MAAA,GAAAiB,IAAA;QAAAlB;MAAA;QACA;QACA,IAAAA,IAAA,CAAAmB,IAAA,CAAAC,MAAA,sBAAAC,QAAA,CAAAC,KAAA,CAAAtB,IAAA,CAAAmB,IAAA,CAAAI,GAAA;QACA,KAAAlB,QAAA,GAAAL,IAAA,CAAAA,IAAA,CAAAwB,KAAA;QACA,KAAAlB,KAAA,GAAAN,IAAA,CAAAA,IAAA,CAAAM,KAAA;MACA;IACA;IACA;IACAmB,iBAAAC,OAAA;MACA;MACA,KAAAzB,SAAA,CAAAG,QAAA,GAAAsB,OAAA;MACA,KAAAV,YAAA;IACA;IACA;IACAW,oBAAAC,OAAA;MACA;MACA,KAAA3B,SAAA,CAAAE,OAAA,GAAAyB,OAAA;MACA,KAAAZ,YAAA;IACA;IACA;IACAa,iBAAAC,QAAA;MACAhC,eAAA,CAAAgC,QAAA,EAAAZ,IAAA;QAAAlB;MAAA;QACA;QACA,IAAAA,IAAA,CAAAmB,IAAA,CAAAC,MAAA;UACAU,QAAA,CAAAC,QAAA,IAAAD,QAAA,CAAAC,QAAA;UACA,YAAAV,QAAA,CAAAC,KAAA;QACA;QACA,KAAAD,QAAA,CAAAW,OAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAjB,YAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}