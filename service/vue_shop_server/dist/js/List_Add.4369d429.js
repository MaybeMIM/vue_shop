"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[991],{4976:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("添加商品")])],1),t("el-card",[t("el-alert",{attrs:{title:"添加商品信息",type:"info",center:"","show-icon":"",closable:!1}}),t("el-steps",{attrs:{space:200,active:e.activeIndex-0,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"基本信息"}}),t("el-step",{attrs:{title:"商品参数"}}),t("el-step",{attrs:{title:"商品属性"}}),t("el-step",{attrs:{title:"商品图片"}}),t("el-step",{attrs:{title:"商品内容"}}),t("el-step",{attrs:{title:"完成！"}})],1),t("el-form",{ref:"addForm",attrs:{"label-position":"top",model:e.addForm,rules:e.addRules,"label-width":"100px"}},[t("el-tabs",{attrs:{"tab-position":"left","before-leave":e.beforeTabLeave},on:{"tab-click":e.tabClicked},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[t("el-input",{model:{value:e.addForm.goods_name,callback:function(t){e.$set(e.addForm,"goods_name",t)},expression:"addForm.goods_name"}})],1),t("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_price,callback:function(t){e.$set(e.addForm,"goods_price",t)},expression:"addForm.goods_price"}})],1),t("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_weight,callback:function(t){e.$set(e.addForm,"goods_weight",t)},expression:"addForm.goods_weight"}})],1),t("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_number,callback:function(t){e.$set(e.addForm,"goods_number",t)},expression:"addForm.goods_number"}})],1),t("el-form-item",{attrs:{label:"商品分类",prop:""}},[t("el-cascader",{attrs:{options:e.cateList,props:e.cateProps,"expand-trigger":"hover"},on:{change:e.handleChange},model:{value:e.addForm.goods_cat,callback:function(t){e.$set(e.addForm,"goods_cat",t)},expression:"addForm.goods_cat"}})],1)],1),t("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manyTableData,(function(a){return t("el-form-item",{key:a.attr_id,attrs:{label:a.attr_name}},[t("el-checkbox-group",{model:{value:a.attr_vals,callback:function(t){e.$set(a,"attr_vals",t)},expression:"item.attr_vals"}},e._l(a.attr_vals,(function(e,a){return t("el-checkbox",{key:a,attrs:{border:"",label:e}})})),1)],1)})),1),t("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlyTableData,(function(a){return t("el-form-item",{key:a.attr_id,attrs:{label:a.attr_name}},[t("el-input",{model:{value:a.attr_vals,callback:function(t){e.$set(a,"attr_vals",t)},expression:"item.attr_vals"}})],1)})),1),t("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[t("el-upload",{attrs:{"on-success":e.handleSuccess,headers:e.headerObj,action:e.uploadURL,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpg/png文件，且不超过500kb ")])],1)],1),t("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[t("quill-editor",{model:{value:e.addForm.goods_introduce,callback:function(t){e.$set(e.addForm,"goods_introduce",t)},expression:"addForm.goods_introduce"}}),t("el-button",{staticClass:"btnAdd",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加商品")])],1)],1)],1)],1),t("el-dialog",{attrs:{title:"图片预览",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{staticClass:"previewImg",attrs:{src:e.previewPath,alt:""}})])],1)},s=[],o=(a(7658),a(2611)),n=a(586),i={name:"Add",data(){return{uploadURL:"http://127.0.0.1:8888/api/private/v1/upload",headerObj:{Authorization:window.sessionStorage.getItem("token")},activeIndex:0,addForm:{goods_name:"",goods_price:0,goods_weight:0,goods_number:0,goods_cat:[],pics:[],goods_introduce:"",attrs:[]},addRules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}]},cateList:[],cateProps:{label:"cat_name",value:"cat_id",children:"children"},manyTableData:[],onlyTableData:[],previewPath:"",dialogVisible:!1}},computed:{cateId(){return 3===this.addForm.goods_cat.length?this.addForm.goods_cat[2]:null}},methods:{getCateListed(){(0,n.hN)().then((({data:e})=>{if(200!==e.meta.status)return this.$message.error("获取商品分类数据失败");this.cateList=e.data}))},handleChange(){3!==this.addForm.goods_cat.length&&(this.addForm.goods_cat=[],this.$message.error("请选择三级商品分类！"))},beforeTabLeave(e,t){if("0"===t&&3!==this.addForm.goods_cat.length)return this.$message.error("请先选中商品分类！"),!1},tabClicked(){"1"===this.activeIndex?(0,n.F4)(this.cateId,{params:{sel:"many"}}).then((({data:e})=>{if(200!==e.meta.status)return this.$message.error("获取动态参数数据失败");e.data.forEach((e=>{e.attr_vals=0===e.attr_vals.length?[]:e.attr_vals.split(" ")})),this.manyTableData=e.data})):"2"===this.activeIndex&&(0,n.F4)(this.cateId,{params:{sel:"only"}}).then((({data:e})=>{if(200!==e.meta.status)return this.$message.error("获取静态参数数据失败");this.onlyTableData=e.data}))},handlePreview(e){this.dialogVisible=!0,this.previewPath=e.response.data.url},handleRemove(e){const t=e.response.data.tmp_path,a=this.addForm.pics.findIndex((e=>e.pic===t));this.addForm.pics.splice(a,1)},handleSuccess(e){this.addForm.pics.push({pic:e.data.tmp_path})},add(){this.$refs.addForm.validate((e=>{if(!e)return this.$message.error("请填写必要的表单项");const t=(0,o.cloneDeep)(this.addForm);t.goods_cat=t.goods_cat.join(","),this.manyTableData.forEach((e=>{const t={attr_id:e.attr_id,attr_value:e.attr_vals.join(" ")};this.addForm.attrs.push(t)})),this.onlyTableData.forEach((e=>{const t={attr_id:e.attr_id,attr_value:e.attr_vals};this.addForm.attrs.push(t)})),t.attrs=this.addForm.attrs,(0,n.Rq)(t).then((({data:e})=>{if(201!==e.meta.status)return this.$message.error("添加商品失败");this.$message.success("添加商品成功"),this.$router.push("/goods")}))}))}},created(){this.getCateListed()}},l=i,d=a(1001),u=(0,d.Z)(l,r,s,!1,null,"05875723",null),c=u.exports},5601:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("商品列表")])],1),t("el-card",[t("el-row",{attrs:{gutter:40}},[t("el-col",{attrs:{span:8}},[t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getGoodsListed},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getGoodsListed},slot:"append"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:e.goAddPage}},[e._v("添加商品")])],1)],1),t("el-table",{attrs:{data:e.goodsList,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"商品名称",prop:"goods_name"}}),t("el-table-column",{attrs:{label:"商品价格(元)",prop:"goods_price",width:"135px"}}),t("el-table-column",{attrs:{label:"商品重量",prop:"goods_weight",width:"95px"}}),t("el-table-column",{attrs:{label:"创建时间",prop:"add_time",width:"175px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.add_time))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit"}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteGood(a.row.goods_id)}}})]}}])})],1),t("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[5,10,15,20],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},s=[],o=(a(7658),a(586)),n={name:"List",data(){return{queryInfo:{query:"",pagenum:1,pagesize:10},goodsList:[],total:0}},methods:{getGoodsListed(){(0,o.od)({params:this.queryInfo}).then((({data:e})=>{if(200!==e.meta.status)return this.$message.error("获取商品列表失败");this.goodsList=e.data.goods,this.total=e.data.total}))},handleSizeChange(e){this.queryInfo.pagesize=e,this.getGoodsListed()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getGoodsListed()},deleteGood(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,o.aH)(e).then((({data:e})=>{if(console.log(e),200!==e.meta.status)return this.$message.error("删除商品失败");this.$message.success("删除商品成功"),this.getGoodsListed()}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},goAddPage(){this.$router.push("/goods/add")}},created(){this.getGoodsListed()}},i=n,l=a(1001),d=(0,l.Z)(i,r,s,!1,null,null,null),u=d.exports},586:function(e,t,a){a.d(t,{tU:function(){return v},Xk:function(){return p},m3:function(){return i},kV:function(){return $},Rq:function(){return T},F1:function(){return x},cn:function(){return c},fu:function(){return _},JG:function(){return k},aH:function(){return z},sW:function(){return L},ZR:function(){return b},h8:function(){return m},fT:function(){return F},AZ:function(){return q},J:function(){return l},hN:function(){return y},GI:function(){return P},od:function(){return C},cu:function(){return G},Qf:function(){return I},F4:function(){return w},EK:function(){return f},WC:function(){return g},Sd:function(){return h},lE:function(){return d},eV:function(){return u}});var r=a(7467),s=a.n(r);const o=s().create({baseURL:"http://127.0.0.1:8888/api/private/v1/",timeout:5e3});o.interceptors.request.use((function(e){return e.headers.Authorization=window.sessionStorage.getItem("token"),e}),(function(e){return Promise.reject(e)})),o.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var n=o;const i=e=>n.post("/login",e),l=()=>n.get("/menus"),d=e=>n.get("users/",e),u=e=>n.put(`users/${e.id}/state/${e.mg_state}`,e),c=e=>n.post("users/",e),p=e=>n.put(`users/${e.id}`,{email:e.email,mobile:e.mobile}),m=e=>n.delete(`users/${e}`,e),g=()=>n.get("rights/list"),h=()=>n.get("roles"),b=(e,t)=>n.delete(`roles/${e.id}/rights/${t}`,e,t),f=()=>n.get("rights/tree"),_=(e,t)=>n.post(`roles/${e}/rights`,t),v=(e,t)=>n.put(`users/${e.id}/role`,t),y=e=>n.get("categories/",e),$=e=>n.post("categories/",e),F=e=>n.put(`categories/${e.cat_id}`,e),k=e=>n.delete(`categories/${e}`,e),w=(e,t)=>n.get(`categories/${e}/attributes`,t),x=(e,t)=>n.post(`categories/${e}/attributes`,t),I=(e,t,a)=>n.get(`categories/${e}/attributes/${t}`,a),q=(e,t,a)=>n.put(`categories/${e}/attributes/${t}`,a),L=(e,t)=>n.delete(`categories/${e}/attributes/${t}`),C=e=>n.get("goods",e),T=e=>n.post("goods",e),z=e=>n.delete(`goods/${e}`),G=e=>n.get("orders",e),P=()=>n.get("reports/type/1")}}]);
//# sourceMappingURL=List_Add.4369d429.js.map